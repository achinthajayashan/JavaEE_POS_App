<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>POS System</title>
    <meta name="viewport" content="width=device-width initial-scale=1 user-scalable=no">
    <link rel="stylesheet" href="assets/normalize.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat&family=Rubik+Iso&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/bootstrap.css">

</head>
<body class="bg-black object-fit-scale">
<header>
    <nav class="navbar navbar-expand-md  bg-black border-bottom border-white">
        <div class="container-fluid">
            <a class="navbar-brand  text-warning" href="#">POS System</a>
            <button class="navbar-toggler bg-warning" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse " id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0 ">
                    <li id="btnHome" class="nav-item">
                        <a class="nav-link text-warning" aria-current="page" href="index.html">Home</a>
                    </li>
                    <li id="btnCustomer" class="nav-item">
                        <a class="nav-link text-white">Customers</a>
                    </li>
                    <li id="btnItem" class="nav-item">
                        <a class="nav-link text-white">Items</a>
                    </li>
                    <li id="btnOrders" class="nav-item">
                        <a class="nav-link text-white">Orders</a>
                    </li>
                    <li id="btnPlaceOrder" class="nav-item ms-4">
                        <a class="nav-link border-warning border bg-warning rounded text-black">Place New
                            Order</a>
                    </li>
                </ul>
                <form class="d-flex me-3" role="search">
                    <input class="form-control me-2 bg-black border border-white text-white" type="search"
                           placeholder="Search" aria-label="Search">
                    <button class="btn btn-outline-light" type="submit">Search</button>
                </form>
                <button type="button" class="btn btn-outline-warning">Sign Up</button>
            </div>
        </div>
    </nav>
</header>

<main id="home" class="bg-black container">
    <section class="container-fluid fl">
        <div class="col  object-fit-contain">
            <div class="object-fit-contain">
                <img src="assets/pngwing.com%20(45).png" style="width: 500px"
                     class="center-block d-block mx-auto object-fit-scale">
            </div>
            <div class="text-white text-center ">
                <h2 class="text-capitalize text-bg-warning">TECHNO COMPUTERS</h2>
                <h4>Your Computer Partner</h4>
                <p>Point Of Sale System By Achintha Jayashan</p>
            </div>
        </div>
    </section>
</main>

<main id="customer" class="container">
    <section class="row p-4 m-0 object-fit-contain">
        <nav aria-label="breadcrumb" class="text-white">
            <ol class="breadcrumb">
                <li class="breadcrumb-item text-white"><a href="index.html">Home</a></li>
                <li class="breadcrumb-item active text-white" aria-current="page">Customers</li>
            </ol>
        </nav>

        <!--        <h5 class="text-warning text-lg-start" >Customer Management</h5>-->
        <div class="col border-warning m-3 border rounded object-fit-contain">
            <h5 class="text-warning text-center m-lg-3 pt-5">Add a New Customer</h5>
            <form class="m-5" id="customerForm">
                <div class="mb-3">
                    <label for="InputCID" class="form-label text-white">Customer ID</label>
                    <input type="text" class="form-control bg-black border-white text-warning focus-ring-warning"
                           id="InputCID" name="cusID">
                </div>
                <div class="mb-3">
                    <label for="InputCusName" class="form-label text-white">Name</label>
                    <input type="text"
                           class="form-control bg-black border-white text-warning focus-ring-warning focus-ring"
                           id="InputCusName" name="cusName">
                </div>
                <div class="mb-3">
                    <label for="inputCusAddress" class="form-label text-white">Address</label>
                    <input type="text"
                           class="form-control bg-black border-white text-warning focus-ring-warning focus-ring"
                           id="inputCusAddress" name="cusAddress">
                </div>
                <div class="mb-3">
                    <label for="inputCusContact" class="form-label text-white">Contact</label>
                    <input type="tel"
                           class="form-control bg-black border-white text-warning focus-ring-warning focus-ring "
                           id="inputCusContact" name="cusContact">
                </div>
                <div class="row m-0 gap-2 mt-5">
                    <button id="btnGetAllCus" type="button" class="btn btn-light col">Get All</button>
                    <button id="btnUpdateCus" type="button" class="btn btn-dark  col">Update</button>
                    <button id="btnDeleteCus" type="button" class="btn btn-danger  col">Delete</button>
                </div>

                <div class="row m-0 gap-2 mt-2">
                    <button id="btnSaveCus" type="button" class="btn btn-warning  col">Save</button>
                </div>
                <!--                <button type="submit" class="btn btn-outline-warning  container-fluid">Save</button>-->
                <!--                <button type="submit" class="btn btn-outline-light disabled container-fluid">Update</button>-->
            </form>
        </div>
        <div class="col border-white m-3  border-start">
            <table class="table text-white">
                <thead class="text-warning">
                <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Name</th>
                    <th scope="col">Address</th>
                    <th scope="col">Contact</th>
                    <th scope="col">Action</th>
                </tr>
                </thead>
                <tbody id="cusTableBody">
                </tbody>
            </table>
        </div>
    </section>
</main>

<main id="item" class="container">
    <section class="row p-4 m-0">
        <nav aria-label="breadcrumb" class="text-white">
            <ol class="breadcrumb">
                <li class="breadcrumb-item text-white"><a href="index.html">Home</a></li>
                <li class="breadcrumb-item active text-white" aria-current="page">Items</li>
            </ol>
        </nav>

        <!--        <h5 class="text-warning text-lg-start" >Customer Management</h5>-->
        <div class="col border-warning m-3 border rounded">
            <h5 class="text-warning text-center m-lg-3 pt-5">Add a New Item</h5>
            <form class="m-5" id="itemForm">
                <div class="mb-3">
                    <label for="InputItemID" class="form-label text-white">Item ID</label>
                    <input type="text" class="form-control bg-black border-white text-warning focus-ring-warning"
                           id="InputItemID" name="txtItemID">
                </div>
                <div class="mb-3">
                    <label for="InputItemDesc" class="form-label text-white">Description</label>
                    <input type="text"
                           class="form-control bg-black border-white text-warning focus-ring-warning focus-ring"
                           id="InputItemDesc" name="txtItemName">
                </div>
                <div class="mb-3">
                    <label for="inputItemUnitPrice" class="form-label text-white">Unit Price</label>
                    <input type="number"
                           class="form-control bg-black border-white text-warning focus-ring-warning focus-ring"
                           id="inputItemUnitPrice" name="txtItemPrice">
                </div>
                <div class="mb-3">
                    <label for="inputItemQty" class="form-label text-white">Quantity</label>
                    <input type="number"
                           class="form-control bg-black border-white text-warning focus-ring-warning focus-ring "
                           id="inputItemQty" name="txtItemQty">
                </div>
                <div class="row m-0 gap-2 mt-5">
                    <button id="btnGetAllItem" type="button" class="btn btn-light col">Get All</button>
                    <button id="btnUpdateItem" type="button" class="btn btn-dark  col">Update</button>
                    <button id="btnDeleteItem" type="button" class="btn btn-danger  col">Delete</button>
                </div>

                <div class="row m-0 gap-2 mt-2">
                    <button id="btnSaveItem" type="button" class="btn btn-warning  col">Save</button>
                </div>
                <!--                <button type="submit" class="btn btn-outline-warning  container-fluid">Save</button>-->
                <!--                <button type="submit" class="btn btn-outline-light disabled container-fluid">Update</button>-->
            </form>
        </div>
        <div class="col border-white m-3  border-start">
            <table class="table text-white">
                <thead class="text-warning">
                <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Description</th>
                    <th scope="col">Unit Price</th>
                    <th scope="col">Qty On Hnd</th>
                    <th scope="col">Action</th>
                </tr>
                </thead>
                <tbody id="tblItems">

                </tbody>
            </table>
        </div>
    </section>
</main>

<main id="orders" class="container col">
    <nav aria-label="breadcrumb" class="text-white">
        <ol class="breadcrumb">
            <li class="breadcrumb-item text-white"><a href="index.html">Home</a></li>
            <li class="breadcrumb-item active text-white" aria-current="page">Orders</li>
        </ol>
    </nav>
    <section class="row  m-auto">
        <table class="table text-white container col">
            <thead class="text-warning">
            <tr>
                <th scope="col">Order ID</th>
                <th scope="col">Date</th>
                <th scope="col">Customer ID</th>
                <th scope="col">Item ID</th>
                <th scope="col">Quantity</th>
                <th scope="col">Discount</th>
                <th scope="col">Total</th>
                <th scope="col">Action</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <th scope="row">O-001</th>
                <td>2023-05-17</td>
                <td>C-001</td>
                <td>I-001</td>
                <td>2</td>
                <td>1000</td>
                <td>30000</td>
                <td>
                    <button type="button" class="btn btn-outline-warning">Edit</button>
                    <button type="button" class="btn btn-outline-danger">Delete</button>
                </td>
            </tr>
            <tr>
                <th scope="row">O-002</th>
                <td>2023-05-17</td>
                <td>C-001</td>
                <td>I-001</td>
                <td>2</td>
                <td>1000</td>
                <td>30000</td>
                <td>
                    <button type="button" class="btn btn-outline-warning">Edit</button>
                    <button type="button" class="btn btn-outline-danger">Delete</button>
                </td>
            </tr>
            <tr>
                <th scope="row">O-003</th>
                <td>2023-05-17</td>
                <td>C-001</td>
                <td>I-001</td>
                <td>2</td>
                <td>1000</td>
                <td>30000</td>
                <td>
                    <button type="button" class="btn btn-outline-warning">Edit</button>
                    <button type="button" class="btn btn-outline-danger">Delete</button>
                </td>
            </tr>

            <tr>
                <th scope="row">O-004</th>
                <td>2023-05-17</td>
                <td>C-001</td>
                <td>I-001</td>
                <td>2</td>
                <td>1000</td>
                <td>30000</td>
                <td>
                    <button type="button" class="btn btn-outline-warning">Edit</button>
                    <button type="button" class="btn btn-outline-danger">Delete</button>
                </td>
            </tr>

            <tr>
                <th scope="row">0-005</th>
                <td>2023-05-17</td>
                <td>C-001</td>
                <td>I-001</td>
                <td>2</td>
                <td>1000</td>
                <td>30000</td>
                <td>
                    <button type="button" class="btn btn-outline-warning">Edit</button>
                    <button type="button" class="btn btn-outline-danger">Delete</button>
                </td>
            </tr>

            </tbody>
        </table>
    </section>
</main>

<main id="placeOrder" class="container-fluid">
    <section class="row p-4 m-0">
        <nav aria-label="breadcrumb" class="text-white">
            <ol class="breadcrumb">
                <li class="breadcrumb-item text-white"><a href="index.html">Home</a></li>
                <li class="breadcrumb-item active text-white" aria-current="page">Place Order</li>
            </ol>
        </nav>

        <!--        <h5 class="text-warning text-lg-start" >Customer Management</h5>-->
        <div class="col border-warning m-3 border rounded">
            <h5 class="text-warning text-center m-lg-3 pt-2">Place A New Order</h5>

            <div class="row ">
                <h6 class="text-white">Invoice Details</h6>
                <form class=" me-3">
                    <div class="row border-bottom border-white">
                        <div class="mb-1 col">
                            <label for="InputOID" class="form-label text-white">Order ID</label>
                            <input type="text"
                                   class="form-control bg-black border-white text-warning focus-ring-warning"
                                   id="InputOID">
                        </div>
                        <div class="mb-1 col mb-4">
                            <label for="InputDate" class="form-label text-white">Date</label>
                            <input type="date"
                                   class="form-control bg-black border-white text-warning focus-ring-warning focus-ring"
                                   id="InputDate">
                        </div>
                    </div>

                    <h6 class="text-warning mt-4">Customer Details</h6>

                    <div class="row border-bottom border-white">
                        <div class="mb-1 col">
                            <label for="selectCusId" class="form-label text-white">Customer ID</label>
                            <select class="form-select bg-black text-warning focus-ring-warning focus-ring"
                                    aria-label="Default select example" id="selectCusId">
                                <option selected>Open this select menu</option>
                            </select>
                        </div>
                        <div class="mb-1 col mb-4">
                            <label for="selectedCusName" class="form-label text-white">Customer Name</label>
                            <input type="text"
                                   class="form-control bg-black border-white text-warning focus-ring-warning focus-ring "
                                   id="selectedCusName" readonly>
                        </div>
                    </div>

                    <h6 class="text-warning mt-4">Item Details</h6>

                    <div class="row">
                        <div class="mb-1 col">
                            <label for="selectItemId" class="form-label text-white">Item ID</label>
                            <select class="form-select bg-black text-warning focus-ring-warning focus-ring"
                                    aria-label="Default select example" id="selectItemId">
                                <option selected>Open this select menu</option>
                            </select>
                        </div>
                        <div class="mb-1 col mb-4">
                            <label for="ItemName" class="form-label text-white">Description</label>
                            <input type="text"
                                   class="form-control bg-black border-white text-warning focus-ring-warning focus-ring "
                                   id="ItemName" readonly>
                        </div>
                    </div>

                    <div class="row">
                        <div class="mb-1 col">
                            <label for="UnitPrice" class="form-label text-white">Unit Price</label>
                            <input type="number"
                                   class="form-control bg-black border-white text-warning focus-ring-warning focus-ring "
                                   id="UnitPrice" readonly>
                        </div>
                        <div class="mb-1 col">
                            <label for="QtyOnHnd" class="form-label text-white">Qty On Hnd</label>
                            <input type="number"
                                   class="form-control bg-black border-white text-warning focus-ring-warning focus-ring "
                                   id="QtyOnHnd" readonly>
                        </div>

                        <div class="mb-1 col">
                            <label for="Qty" class="form-label text-white">Qty</label>
                            <input type="number"
                                   class="form-control bg-black border-white text-warning focus-ring-warning focus-ring "
                                   id="Qty">
                        </div>
                    </div>


                </form>
            </div>

            <button class="btn btn-outline-light container-fluid mt-5 mb-5" type="button" id="btnAddToCart">Add To Cart</button>
        </div>

        <div class="col m-3 ">
            <div class="border rounded border-warning">
                <h5 class="text-warning mt-4 mb-3 ms-2">Cart</h5>
                <table class="table text-white ">
                    <thead class="text-warning">
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">Description</th>
                        <th scope="col">Unit Price</th>
                        <th scope="col">Qty</th>
                        <th scope="col">Total</th>
                        <th scope="col">Action</th>
                    </tr>
                    </thead>
                    <tbody id="tblCart">
                    </tbody>
                </table>
            </div>
            <div class="row mt-5 border border-warning rounded">
                <h5 class="text-warning  mt-3 mb-2">Purcahse Order</h5>
                <div class="row">
                    <div class="mb-1 col">
                        <label for="inputTotal" class="form-label text-white">Total</label>
                        <input type="number"
                               class="form-control bg-black border-white text-warning focus-ring-warning focus-ring "
                               id="inputTotal" readonly>
                    </div>

                    <div class="mb-5 col text-warning">
                        <label for="inputSubTotal" class="form-label ">Sub Total</label>
                        <input type="number"
                               class="form-control bg-black border-warning text-warning focus-ring-warning focus-ring mb-4 rounded"
                               id="inputSubTotal" readonly>
                    </div>
                </div>

                <div class="row">
                    <div class="mb-1 col">
                        <label for="inputCash" class="form-label text-white">Cash</label>
                        <input type="number"
                               class="form-control bg-black border-white text-warning focus-ring-warning focus-ring "
                               id="inputCash">
                    </div>

                    <div class="mb-1 col">
                        <label for="inputDiscount" class="form-label text-white">Discount</label>
                        <input type="number"
                               class="form-control bg-black border-white text-warning focus-ring-warning focus-ring "
                               id="inputDiscount">
                    </div>

                    <div class="mb-1 col">
                        <label for="inputBalance" class="form-label text-white">Balance</label>
                        <input type="number"
                               class="form-control bg-black border-white text-warning focus-ring-warning focus-ring "
                               id="inputBalance" readonly>
                    </div>

                </div>
                <div class="row ms-1">
                    <button class="btn btn-outline-warning mt-5 mb-5" type="button" id="btnPurchaseOrder">Purchace</button>
                </div>

            </div>
        </div>
    </section>
</main>

<script src="assets/js/bootstrap.js"></script>
<script src="assets/jquery-3.7.0.min.js"></script>
<script>
    //hide and show functions of pages-->

    $('#home').show();
    $('#customer').hide();
    $('#item').hide();
    $('#orders').hide();
    $('#placeOrder').hide();

    let cartItems;
    let subTotal=0;
    let discount=0;
    let finalTotal=0;

    $('#btnCustomer').click(function () {
        $('#home').hide();
        $('#customer').show();
        $('#item').hide();
        $('#orders').hide();
        $('#placeOrder').hide();

        getAllCustomers();
    });

    $('#btnItem').click(function () {
        $('#home').hide();
        $('#customer').hide();
        $('#item').show();
        $('#orders').hide();
        $('#placeOrder').hide();

        getAllItems();
    });

    $('#btnOrders').click(function () {
        $('#home').hide();
        $('#customer').hide();
        $('#item').hide();
        $('#orders').show();
        $('#placeOrder').hide();
    });

    $('#btnPlaceOrder').click(function () {
        $('#home').hide();
        $('#customer').hide();
        $('#item').hide();
        $('#orders').hide();
        $('#placeOrder').show();

        loadCusIds();
        loadItemIds();
         cartItems=[];
    });


    // ------------------------------------------------ customer -------------------------------------------------------

    // get all customers

    $('#btnGetAllCus').click(function () {
        getAllCustomers();
    })

    function getAllCustomers() {
        $("#cusTableBody").empty();
        <!--send ajax request to the customer servlet using jQuery-->
        $.ajax({
            url: 'http://localhost:8080/JavaEE_Pos/customer',
            dataType: "json",
            success: function (customers) {
                for (let i in customers) {
                    let cus = customers[i];
                    let id = cus.id;
                    let name = cus.name;
                    let address = cus.address;
                    let contact = cus.contact;
                    let row = `<tr><td>${id}</td><td>${name}</td><td>${address}</td><td>${contact}</td></tr>`;
                    $("#cusTableBody").append(row);
                    bindTrEvents();
                }
            },
            error: function (error) {
                console.log(error);
            }
        });

    }


    //bind event customer table
    function bindTrEvents() {
        $('#cusTableBody>tr').click(function () {
            //get the selected rows data
            let id = $(this).children().eq(0).text();
            let name = $(this).children().eq(1).text();
            let address = $(this).children().eq(2).text();
            let contact = $(this).children().eq(3).text();

            //set the selected rows data to the input fields
            $("#InputCID").val(id);
            $("#InputCusName").val(name);
            $("#inputCusAddress").val(address);
            $("#inputCusContact").val(contact);
        })
    }

    //customer save

    $("#btnSaveCus").click(function () {
        let formData = $("#customerForm").serialize();
        $.ajax({
            url: 'http://localhost:8080/JavaEE_Pos/customer',
            method: "post",
            data: formData,
            success: function (res) {
                console.log(res);
                alert(res.message);
                getAllCustomers();
            },
            error: function (error) {
                console.log(error.responseJSON);
                alert(error.responseJSON.message);
            }
        });

    });

    //customer update

    $("#btnUpdateCus").click(function () {

        let id = $("#InputCID").val();
        let name = $("#InputCusName").val();
        let address = $("#inputCusAddress").val();
        let contact = $("#inputCusContact").val();

        //json object
        let a = {
            "cusID": id,
            "cusName": name,
            "cusAddress": address,
            "cusContact": contact
        }


        $.ajax({
            url: 'http://localhost:8080/JavaEE_Pos/customer',
            method: 'put',
            origin: "*",
            // header: "Access-Control-Allow-Origin",
            setRequestHeader: "Access-Control-Allow-Origin",
            contentType: "application/json",
            data: JSON.stringify(a),
            success: function (resp) {
                getAllCustomers();
                alert(resp.message);
            },
            error: function (error) {
                alert(error.responseJSON.message);
            }
        });
    });


    //customer delete

    $("#btnDeleteCus").click(function () {
        console.log("clicked");
        let cusID = $('#InputCID').val();

        $.ajax({
            url: 'http://localhost:8080/JavaEE_Pos/customer?cusID=' + cusID,
            type: "DELETE",
            dataType: "json",
            contentType: "application/json",
            // data:JSON.stringify(cusID),
            success: function (res) {
                getAllCustomers()
                alert(res.message);
            },
            error: function (error) {
                alert(error.message)
            }
        })
    });



    // ------------------------------------------------ item -------------------------------------------------------

    // get all items

    $('#btnGetAllItem').click(function () {
        getAllItems();
    })

    function getAllItems() {
        $("#tblItems").empty();
        <!--send ajax request to the item servlet using jQuery-->
        $.ajax({
            url: 'http://localhost:8080/JavaEE_Pos/item',
            dataType: "json",
            success: function (items) {
                for (let i in items) {
                    let item = items[i];
                    let code = item.code;
                    let desc = item.desc;
                    let unitPrice = item.unitPrice;
                    let qty = item.qty;
                    let row = `<tr><td>${code}</td><td>${desc}</td><td>${unitPrice}</td><td>${qty}</td></tr>`;
                    $("#tblItems").append(row);
                    bindTrEventsItem();
                }
            },
            error: function (error) {
                console.log(error);
            }
        });

    }


    //bind event item table
    function bindTrEventsItem() {
        $('#tblItems>tr').click(function () {
            //get the selected rows data
            let code = $(this).children().eq(0).text();
            let desc = $(this).children().eq(1).text();
            let unitPrice = $(this).children().eq(2).text();
            let qty = $(this).children().eq(3).text();

            //set the selected rows data to the input fields
            $("#InputItemID").val(code);
            $("#InputItemDesc").val(desc);
            $("#inputItemUnitPrice").val(unitPrice);
            $("#inputItemQty").val(qty);
        })
    }

    //customer save

    $("#btnSaveItem").click(function () {
        let formData = $("#itemForm").serialize();
        $.ajax({
            url: 'http://localhost:8080/JavaEE_Pos/item',
            method: "post",
            data: formData,
            success: function (res) {
                console.log(res);
                alert(res.message);
                getAllItems();
            },
            error: function (error) {
                console.log(error.responseJSON);
                alert(error.responseJSON.message);
            }
        });

    });

    //customer update

    $("#btnUpdateItem").click(function () {

        let code = $("#InputItemID").val();
        let desc = $("#InputItemDesc").val();
        let unitPrice = $("#inputItemUnitPrice").val();
        let qty = $("#inputItemQty").val();

        //json object
        let a = {
            "code": code,
            "desc": desc,
            "unitPrice": unitPrice,
            "qty": qty
        }


        $.ajax({
            url: 'http://localhost:8080/JavaEE_Pos/item',
            method: 'put',
            origin: "*",
            // header: "Access-Control-Allow-Origin",
            setRequestHeader: "Access-Control-Allow-Origin",
            contentType: "application/json",
            data: JSON.stringify(a),
            success: function (resp) {
                getAllItems();
                alert(resp.message);
            },
            error: function (error) {
                alert(error.responseJSON.message);
            }
        });
    });


    //customer delete

    $("#btnDeleteItem").click(function () {
        console.log("clicked");
        let code = $('#InputItemID').val();

        $.ajax({
            url: 'http://localhost:8080/JavaEE_Pos/item?code=' + code,
            type: "DELETE",
            dataType: "json",
            contentType: "application/json",
            // data:JSON.stringify(cusID),
            success: function (res) {
                getAllItems();
                alert(res.message);
            },
            error: function (error) {
                alert(error.message)
            }
        })
    });


    //-----------------------------------------------------purchase order-----------------------------------------------

    //load customer ids

    function loadCusIds() {
        var optionCus = '';

        $.ajax({
            url: 'http://localhost:8080/JavaEE_Pos/customer',
            dataType: "json",
            success: function (customers) {
                for (let i in customers) {
                    let cus = customers[i];
                    let id = cus.id;
                    optionCus += '<option value="' +id + '">' + id + '</option>';
                }
                $('#selectCusId').append(optionCus);
            },
            error: function (error) {
                console.log(error);
            }
        });

    }

    //set Customer name according to cus id

    $('#selectCusId').change(function(){ //the event here is change
            let thisVal=$(this).val();
        $.ajax({
            url: 'http://localhost:8080/JavaEE_Pos/customer',
            dataType: "json",
            success: function (customers) {
                for (let i in customers) {
                    let cus = customers[i];
                    let id = cus.id;
                    let name = cus.name;
                    if (thisVal == id){
                        $('#selectedCusName').val(name)
                        break;
                    }
                }
            },
            error: function (error) {
                console.log(error);
            }
        });

    });

    //load item ids
    function loadItemIds() {
        var optionItem = '';

        $.ajax({
            url: 'http://localhost:8080/JavaEE_Pos/item',
            dataType: "json",
            success: function (items) {
                for (let i in items) {
                    let item = items[i];
                    let code = item.code;
                    optionItem += '<option value="' +code + '">' + code + '</option>';
                }
                $('#selectItemId').append(optionItem);
            },
            error: function (error) {
                console.log(error);
            }
        });

    }

    //set Customer name according to cus id

    $('#selectItemId').change(function(){ //the event here is change
        let thisVal=$(this).val();
        $.ajax({
            url: 'http://localhost:8080/JavaEE_Pos/item',
            dataType: "json",
            success: function (items) {
                for (let i in items) {
                    let item = items[i];
                    let code = item.code;
                    let desc = item.desc;
                    let unitPrice = item.unitPrice;
                    let qtyOnHnd = item.qty;
                    if (thisVal == code){
                        $('#ItemName').val(desc);
                        $('#UnitPrice').val(unitPrice);
                        $('#QtyOnHnd').val(qtyOnHnd);

                        break;
                    }
                }
            },
            error: function (error) {
                console.log(error);
            }
        });

    });

    // Add to Cart function

    $('#btnAddToCart').click(function () {
        addToCart();
    });

    function addToCart() {
        subTotal=0;
        let itemCode = $('#selectItemId').val();
        let itemName = $('#ItemName').val();
        let itemUnitPrice = $('#UnitPrice').val();
        let qty = $('#Qty').val();
        let totalofRow = itemUnitPrice*qty;

        let cartItemsRow=[];

        cartItemsRow.push(itemCode,itemName,itemUnitPrice,qty,totalofRow);

        let row = `<tr><td>${itemCode}</td><td>${itemName}</td><td>${itemUnitPrice}</td><td>${qty}</td><td>${totalofRow}</td></tr>`;
        $("#tblCart").append(row);


        cartItems.push(cartItemsRow);

        console.log(cartItemsRow);
        console.log(cartItems);


        for (let i = 0; i <= cartItems.length; i++) {
            subTotal+=cartItems[i][4];
             finalTotal=subTotal;
            $('#inputTotal').val(parseInt(subTotal));
            $('#inputSubTotal').val(parseInt(finalTotal));
            console.log(parseInt(subTotal));
        }
    }

    //add discount
    $('#inputDiscount').keydown(function (event){

        if (event.key==='Enter'){
            if ($('#inputDiscount').val()!=="0"){
                 fullTotal = subTotal-Number($('#inputDiscount').val());

                $('#inputSubTotal').val(fullTotal);
            }
        }

    });

    //balance set
    $('#inputCash').keydown(function (event){

        if (event.key==='Enter'){
            let balance = Number($('#inputCash').val())-Number($('#inputSubTotal').val());

            $('#inputBalance').val(balance);
            //purchaseOrder();
        }

    });

    //purchase order

    $('#btnPurchaseOrder').click(function () {
        let oID = $('#InputOID').val();
        let oDate= $('#InputDate').val();
        let oCusID= $('#selectCusId').val();
        let oItemID= $('#selectItemId').val();
        let oItemName= $('#ItemName').val();
        let oUnitPrice= $('#UnitPrice').val();
        let oQty= $('#Qty').val();
        let oCartItems=cartItems;

        console.log(oID,oDate,oCusID,oItemID,oItemName,oUnitPrice,oQty);
        console.log(oCartItems);

        let a = {
            "oID": oID,
            "oDate": oDate,
            "oCusID": oCusID,
            "oItemID": oItemID,
            "oItemName": oItemName,
            "oUnitPrice": oUnitPrice,
            "oQty": oQty,
            "oCartItems": oCartItems
        }

        $.ajax({
            url: 'http://localhost:8080/JavaEE_Pos/placeOrder',
            method: "post",
            setRequestHeader:"Access-Control-Allow-Origin",
            origin:"*",
            contentType: "application/json",
            data: JSON.stringify(a),
            success: function (resp) {
                // alert(resp.message);
                // console.log(resp.message)
            },
            error: function (error) {
                // alert(error.responseJSON.message);
                // console.log(error.message)
            }
        });

    })






</script>
</body>

</html>